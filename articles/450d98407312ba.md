---
title: "jsã§group byã™ã‚‹ãƒ¡ãƒ¢"
emoji: "ğŸ‡"
type: "tech"
topics:
  - "javascript"
  - "typescript"
published: true
published_at: "2021-09-23 18:11"
---

# WHY

ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªã‚¹ãƒˆã«å¯¾ã—ã¦ã€SQLã®ã‚ˆã†ã«group byã—ã¦countã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒæ¬²ã—ã‹ã£ãŸ

# HOW

- ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«countã‚’è¿½åŠ ã™ã‚‹ã®ã§ã¯ãªãã€ã²ã¨ã¤éšå±¤ã‚’å¢—ã‚„ã—ã¦ã€`data`ã«å…ƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã€`count` ã«ã‚«ã‚¦ãƒ³ãƒˆæ•°ã‚’å…¥ã‚Œã‚‹ã‚ˆã†ã«ã—ãŸã€‚
    - listã«æ¸¡ã•ã‚Œã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯åŒã˜å‹ã‚’æŒã£ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹æƒ³å®š
- reduceã§ã‚«ã‚¦ãƒ³ãƒˆã—ã¦ã€æœ€å¾Œmapã§æ•´å½¢

```tsx
export const groupBy = <T, K extends keyof T>(
  list: T[],
  groupingField: K
): {
  data: T;
  count: number;
}[] => {
  return (
    list
      // 'groupingField' ã®keyã§ä¸€è‡´ã™ã‚‹objãŒã‚ã£ãŸã‚‰count up
      .reduce((acc, cur) => {
        const result = acc.find(
          (el) => el[groupingField] === cur[groupingField]
        );
        if (result) {
          result.count += 1;
        } else {
          acc.push({
            ...cur,
            count: 1,
          });
        }
        return acc;
      }, [])
      // è¿”ã‚Šå€¤ã«åˆã‚ã›ã‚‹
      .map(({ count, ...rest }) => ({
        data: rest,
        count,
      }))
  );
};
```

# Reference

- reduce

    [Array.prototype.reduce() - JavaScript | MDN](https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce#%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E9%85%8D%E5%88%97%E3%81%AE%E5%80%A4%E3%81%AE%E5%90%88%E8%A8%88%E5%80%A4%E3%82%92%E5%87%BA%E3%81%99)

- å¼•æ•°ã‚’ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã«é™å®šã™ã‚‹ã®ã©ã†ã‚„ã‚‹ã‚“ã ã£ã‘ã¨æ€ã„

    [Documentation - Generics](https://www.typescriptlang.org/docs/handbook/2/generics.html#using-type-parameters-in-generic-constraints)