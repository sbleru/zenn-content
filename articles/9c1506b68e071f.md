---
title: "Reactã§ã‚ªãƒ•ãƒ©ã‚¤ãƒ³é€šçŸ¥ã‚’å‡ºã—ãŸã„ï¼ with ChatGPT"
emoji: "ğŸ“˜"
type: "tech"
topics:
  - "react"
  - "chatgpt"
published: true
published_at: "2023-04-09 01:31"
---

# ä½•ï¼Ÿ

- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ãªã£ãŸã‚‰ãã®æ—¨ã‚’çŸ¥ã‚‰ã›ã‚‹UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ãŸã„
- ã›ã£ã‹ããªã®ã§ChatGPTã¨ç›¸è«‡ã—ã¦ä½œã£ã¦ã¿ãŸã„ï¼ˆâ†ã“ã£ã¡ãƒ¡ã‚¤ãƒ³ã‹ã‚‚ï¼‰

## TL;DR

- ChatGPTã‚’ã‚³ãƒ¼ãƒ‰ã®å©ãã«ä½¿ã£ã¦ãã‚Œã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã®è‰¯ã•ã’
- ã§ããŸã‚³ãƒ¼ãƒ‰
	:::details ã‚¿ã‚¤ãƒˆãƒ«
	```tsx
	import { useToast } from '@chakra-ui/react';
	import { useCallback, useEffect, useState } from 'react';

	type UseNetworkStatus = () => { isOnline: boolean }

	type OfflineNotificationProps = {
	  useNetworkStatus: UseNetworkStatus
	}

	export const OfflineNotification: FC<OfflineNotificationProps> = (props) => {
	  const { useNetworkStatus = useNetworkStatus_ } = props;
	  const { isOnline } = useNetworkStatus();
	  const toast = useToast();

	  useEffect(() => {
	    if (!isOnline) {
	      toast({
		title: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ãªã‚Šã¾ã—ãŸ',
		status: 'error',
		isClosable: true,
	      });
	    }
	  }, [isOnline, toast]);

	  return (
	    <div>
	      {isOnline ? (
		<p>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ã™</p>
	      ) : (
		<p>ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã™</p>
	      )}
	    </div>
	  );
	}

	const useNetworkStatus_ = () => {
	  const [isOnline, setIsOnline] = useState(navigator.onLine);

	  const handleOnline = useCallback(() => setIsOnline(true), []);
	  const handleOffline = useCallback(() => setIsOnline(false), []);

	  useEffect(() => {
	    window.addEventListener('online', handleOnline);
	    window.addEventListener('offline', handleOffline);
	    return () => {
	      window.removeEventListener('online', handleOnline);
	      window.removeEventListener('offline', handleOffline);
	    };
	  }, []);

	  return {
	    isOnline,
	  };
	}
	```
	:::

# ã©ã†ã‚„ã‚‹ï¼Ÿ

## ChatGPTã«ç›¸è«‡ã—ã¦ã¿ã‚‹

è³ªå•

> ã‚ãªãŸã¯Reactã‚’æ‰±ã†ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™ã€‚uiãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦Chakra UIã‚’æ‰±ã„ã¾ã™ã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ãªã£ãŸæ™‚ã«ã€ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’å‡ºã—ãŸã„ã€‚ã“ã®æ™‚ã®Reactã®ã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«ã‚’å‡ºã—ã¦ãã ã•ã„ã€‚
> 

å›ç­”

> ä»¥ä¸‹ã¯Reactã¨Chakra UIã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ãªã£ãŸå ´åˆã«ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã®ä¾‹ã§ã™ã€‚
> 

```jsx
import { useState, useEffect } from 'react';
import { useToast } from '@chakra-ui/react';

function App() {
  const [isOnline, setIsOnline] = useState(navigator.onLine);
  const toast = useToast();

  useEffect(() => {
    const handleOnline = () => setIsOnline(true);
    const handleOffline = () => {
      setIsOnline(false);
      toast({
        title: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ãªã‚Šã¾ã—ãŸ',
        status: 'error',
        isClosable: true,
      });
    };

    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);

    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, [toast]);

  return (
    <div>
      {isOnline ? (
        <p>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ã™</p>
      ) : (
        <p>ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã™</p>
      )}
    </div>
  );
}

export default App;
```

> ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€ **`useState`**
ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ç¾åœ¨ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã®çŠ¶æ…‹ã‚’ç®¡ç†ã—ã¾ã™ã€‚ **`useEffect`**
ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã® **`online`**
/**`offline`**
 ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç›£è¦–ã—ã€çŠ¶æ…‹ã‚’æ›´æ–°ã—ã¦ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ **`useToast`**
ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦Chakra UIã®ãƒˆãƒ¼ã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚æœ€å¾Œã«ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§çŠ¶æ…‹ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«æ¡ä»¶ä»˜ããƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
> 

ãŠãŠãã‚Œã£ã½ã„ã€‚å‹•ãã€‚

ã‚‚ã†å°‘ã—æ•´ãˆã¦ã¿ã‚‹ã€‚

è³ªå•

> å‰è¿°ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ãŸã„ã€‚ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã‹ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çŠ¶æ³ã‚’æ¤œçŸ¥ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã¨ã€ãã‚Œã‚’åˆ©ç”¨ã—ã¦ãƒˆãƒ¼ã‚¹ãƒˆã§ã‚ªãƒ•ãƒ©ã‚¤ãƒ³é€šçŸ¥ã‚’è¡Œã†UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«åˆ†ã‘ã¦ãã ã•ã„ã€‚
> 

å›ç­”

> ä»¥ä¸‹ã¯ã€å‰è¿°ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã¨UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«åˆ†ã‘ãŸä¾‹ã§ã™ã€‚
> 

```jsx
// useNetworkStatus.js
import { useState, useEffect } from 'react';

function useNetworkStatus() {
  const [isOnline, setIsOnline] = useState(navigator.onLine);

  useEffect(() => {
    const handleOnline = () => setIsOnline(true);
    const handleOffline = () => setIsOnline(false);

    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);

    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  return isOnline;
}

export default useNetworkStatus;
```

```jsx
// OfflineNotification.js
import { useToast } from '@chakra-ui/react';
import useNetworkStatus from './useNetworkStatus';

function OfflineNotification() {
  const isOnline = useNetworkStatus();
  const toast = useToast();

  useEffect(() => {
    if (!isOnline) {
      toast({
        title: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ãªã‚Šã¾ã—ãŸ',
        status: 'error',
        isClosable: true,
      });
    }
  }, [isOnline, toast]);

  return null;
}

export default OfflineNotification;
```

> ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ **`useNetworkStatus`** ã¯ã€ç¾åœ¨ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã®çŠ¶æ…‹ã‚’ç›£è¦–ã—ã€ãã‚Œã‚’è¿”ã—ã¾ã™ã€‚UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ **`OfflineNotification`** ã¯ã€ã“ã®çŠ¶æ…‹ã‚’ä½¿ç”¨ã—ã¦ã€ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚çŠ¶æ…‹ãŒå¤‰åŒ–ã™ã‚‹ãŸã³ã« **`useEffect`**ãƒ•ãƒƒã‚¯ãŒå‘¼ã³å‡ºã•ã‚Œã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã®å ´åˆã«ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ **`return null`** ã¯ã€UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒä½•ã‚‚æç”»ã—ãªã„ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚
> 
> 
> ã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹æˆã§ãã¾ã™ã€‚
> 

```jsx
import OfflineNotification from './OfflineNotification';

function App() {
  return (
    <div>
      <OfflineNotification />
      <p>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ã™</p>
    </div>
  );
}

export default App;
```

> ã“ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€ **`OfflineNotification`**
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ **`App`**
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚ **`OfflineNotification`**
ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ãªã£ãŸå ´åˆã«ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚çŠ¶æ…‹ã¯ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ **`useNetworkStatus`**
ã§ç®¡ç†ã•ã‚Œã¾ã™ã€‚æœ€å¾Œã«ã€çŠ¶æ…‹ãŒå¤‰æ›´ã•ã‚Œã‚‹ãŸã³ã« **`OfflineNotification`**
ãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚
> 

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®åå‰ã„ã„æ„Ÿã˜ã«æ±ºã‚ã¦ãã‚Œã‚‹ã®åœ°å‘³ã«å¬‰ã—ã„ã€‚

## ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹

ã“ã®ã¾ã¾ã§ã‚‚å‹•ä½œã¯ã—ã¾ã™ã—ã¾ã‚ã„ã„ã®ã§ã™ãŒã€ã‚‚ã†ã¡ã‚‡ã£ã¨storybookã‚„ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã‚„ã™ã„è¨­è¨ˆã«ã—ãŸã„ã¨æ€ã„ã¾ã—ãŸã€‚

- ç¾çŠ¶ã ã¨OfflineNotificationã®storybookã§ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ã®ã‚‚ã®ã‚’æ›¸ã“ã†ã¨æ€ã†ã¨ã€navigatorã‚’ãƒ¢ãƒƒã‚¯ã™ã‚‹ã—ã‹ãªã•ãã†ï¼Ÿä¾‹ãˆã°spyOnã§ã€‚
- ã¤ã¾ã‚Šã€UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³åˆ¤å®šã«navigatorã®å‡¦ç†ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ãªã‘ã‚Œã°ã„ã‘ãªã„ã€‚ã‚‚ã—ã‚ªãƒ³ãƒ©ã‚¤ãƒ³åˆ¤å®šå‡¦ç†ã«navigatorã‚’ä½¿ã‚ãªããªã£ãŸã‚‰storybookãŒå£Šã‚Œã‚‹ã€‚
- UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚ªãƒ³ãƒ©ã‚¤ãƒ³åˆ¤å®šå‡¦ç†ã®å…·ä½“ã‚’çŸ¥ã£ã¦ã„ã‚‹å¿…è¦ã¯ãªã„ã¯ãšã€‚

### ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’æ³¨å…¥ã™ã‚‹

- OfflineNotification ã« ã‚ªãƒ³ãƒ©ã‚¤ãƒ³åˆ¤å®šã®ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯è‡ªä½“ã‚’æ¸¡ã™
  - å‚è€ƒ: [Firebase ã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰é©åˆ‡ã«éš è”½ã™ã‚‹ãŸã‚ã®ã€ŒHooks Injection ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ - JXé€šä¿¡ç¤¾ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒ–ãƒ­ã‚°](https://tech.jxpress.net/entry/never-give-up-firebase#f-dd66d09e)
- ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’navigatorã‚’ä½¿ã£ãŸåˆ¤å®šå‡¦ç†ã‚’è¡Œã†ã‚‚ã®ã«ã™ã‚‹

```tsx
import { useToast } from '@chakra-ui/react';
import { useCallback, useEffect, useState } from 'react';

type UseNetworkStatus = () => { isOnline: boolean }

type OfflineNotificationProps = {
  useNetworkStatus: UseNetworkStatus
}

export const OfflineNotification: FC<OfflineNotificationProps> = (props) => {
  const { useNetworkStatus = useNetworkStatus_ } = props;
  const { isOnline } = useNetworkStatus();
  const toast = useToast();

  useEffect(() => {
    if (!isOnline) {
      toast({
        title: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã«ãªã‚Šã¾ã—ãŸ',
        status: 'error',
        isClosable: true,
      });
    }
  }, [isOnline, toast]);

  return (
    <div>
      {isOnline ? (
        <p>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§ã™</p>
      ) : (
        <p>ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã™</p>
      )}
    </div>
  );
}

const useNetworkStatus_ = () => {
  const [isOnline, setIsOnline] = useState(navigator.onLine);

  const handleOnline = useCallback(() => setIsOnline(true), []);
  const handleOffline = useCallback(() => setIsOnline(false), []);

  useEffect(() => {
    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);
    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  return {
    isOnline,
  };
}
```

ã“ã†ã™ã‚‹ã“ã¨ã§ã€storybookã§ã¯UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ä»»æ„ã®ãƒ¢ãƒƒã‚¯ãªã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã‚’æ¸¡ã—ã¦ã€UIä½œæˆã«é›†ä¸­ã§ãã‚‹ã€‚

storybookã¯ä¾‹ãˆã°ã“ã†ãªã‚‹

```jsx
import { ComponentMeta, ComponentStoryObj } from "@storybook/react"
import React, { ComponentProps } from "react"
import { OfflineNotification } from "./OfflineNotification"

type Meta = ComponentMeta<typeof OfflineNotification>
type Story = ComponentStoryObj<typeof OfflineNotification>

const componentMeta: Meta = {
  component: OfflineNotification
}

export default componentMeta

const Default: Story = {
  render: () => {
    return <OfflineNotification useNetworkStatus={() => ({ isOnline: false })} />
  }
}

export const Offline: Story = Default

export const Online: Story = {
  ...Default,
  render: () => {
    return <OfflineNotification useNetworkStatus={() => ({ isOnline: true })} />
  }
}
```

:::details storybookã‚¤ãƒ¡ãƒ¼ã‚¸
ã‚ªãƒ³ãƒ©ã‚¤ãƒ³
![](https://storage.googleapis.com/zenn-user-upload/eb1d05b51fcc-20230409.png)
ã‚ªãƒ•ãƒ©ã‚¤ãƒ³
![](https://storage.googleapis.com/zenn-user-upload/017cd5247842-20230409.png)
:::

# ã¾ã¨ã‚

- ChatGPTã‚’å©ãã«ä½¿ã†ã®ã„ã„ãªã¨æ€ã£ãŸ
  - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚‚ã‚‚ã£ã¨ã†ã¾ãè¨€è‘‰ä½¿ãˆã°è‡ªåˆ†ã§ã‚„ã‚‹å¿…è¦ãªã‹ã£ãŸã®ã‹ã‚‚
  - æƒ…å ±å¤ã‹ã£ãŸã‚Šã™ã‚‹ã®ã§å‡¦ç†ãŒæœ¬å½“ã«åˆã£ã¦ã‚‹ã‹ã¯èª¿ã¹ã‚‹å¿…è¦ã¯ã‚ã‚Šãã†

# å‚è€ƒ

- [Firebase ã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰é©åˆ‡ã«éš è”½ã™ã‚‹ãŸã‚ã®ã€ŒHooks Injection ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ - JXé€šä¿¡ç¤¾ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒ–ãƒ­ã‚°](https://tech.jxpress.net/entry/never-give-up-firebase)
- [Navigator.onLine - Web API | MDN](https://developer.mozilla.org/ja/docs/Web/API/Navigator/onLine)