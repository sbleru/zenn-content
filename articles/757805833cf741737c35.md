---
title: "Nodeè£½CLIã§ã€ŒBLEACHã€ã®å§‹è§£ãƒ»åè§£ã‚’ç¢ºèªã—ãŸã„ï¼"
emoji: "ğŸ—‚"
type: "tech"
topics:
  - "npm"
  - "cli"
  - "node"
published: true
published_at: "2020-10-26 20:54"
---

å”çªã«ã€ŒBLEACHã€ã®ç™»å ´äººç‰©ã®è§£å·ãƒ»å§‹è§£ãƒ»åè§£ã‚’ãƒ‘ãƒƒã¨ç¢ºèªã§ãã‚‹ã‚„ã¤æ¬²ã—ã„ï¼ã¨æ€ã£ãŸã®ã§ä½œã‚Šã¾ã—ãŸã€‚
ã€Œblchã€ã‚³ãƒãƒ³ãƒ‰ã€‚ [blch  -  npm](https://www.npmjs.com/package/blch)
nodeã«ã‚ˆã‚‹cliä½œæˆã€œå…¬é–‹ã¾ã§ã€‚

https://qiita.com/bleru/items/e0b349ef6a35e4793f96
ã“ã¡ã‚‰ã®è¨˜äº‹ãã®ã¾ã¾ã€‚

## TL;DR

`npm install -g blch`ã§ï¼

ã§ãã‚‹ã“ã¨

* ç™»å ´äººç‰©ã®ãƒªã‚¹ãƒˆè¡¨ç¤º
* æŒ‡å®šã—ãŸäººç‰©ã®è§£å·ãƒ»æ–¬é­„åˆ€ãƒ»åè§£ã®è¡¨ç¤º
* å§‹è§£
* åè§£

ï¼Šå…¨ã¦ã®ç™»å ´äººç‰©ã‚’ç¶²ç¾…ã—ã¦ã„ã¾ã›ã‚“
ï¼ŠåŸºæœ¬çš„ã«**ç ´é¢ç¯‡**ã¾ã§ã®ç™»å ´äººç‰©ã‚’æ‰±ã„ã¾ã™ãŒã€ä¸€éƒ¨åè§£ã¯**åƒå¹´è¡€æˆ¦ç¯‡**ä»¥é™ã§ç™ºç¾ã—ãŸã‚‚ã®ã‚‚æ‰±ã£ã¦ã„ã¾ã™
ï¼Šååˆƒ(ã‚¨ã‚¹ãƒ‘ãƒ¼ãƒ€)ã®å ´åˆã¯å§‹è§£ãƒ»åè§£ã§ã¯ãªãå¸°åˆƒã‚’æ‰±ã„ã¾ã™

äººç‰©è¿½åŠ ãƒ»ç·¨é›†ãƒ»ä¿®æ­£ã¯ã“ã¡ã‚‰ã‹ã‚‰è‡ªç”±ã«ã—ã¦ã„ãŸã ã„ã¦æ§‹ã„ã¾ã›ã‚“ã€‚
https://docs.google.com/spreadsheets/d/1e7Ms9sX2m1xu_4r20AgyIZHFgByRQp1s93ZE2PZlEaM/edit#gid=0
ã“ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰CSVã‚’ä½œæˆã—ã€è©²å½“ã™ã‚‹ã‚‚ã®ã‚’æ•´å½¢ã—ã¦è¡¨ç¤ºã™ã‚‹ã¨ã„ã†ä»•çµ„ã¿ã«ãªã£ã¦ã„ã¾ã™ã€‚
ï¼Šã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ›´æ–°ã•ã‚ŒãŸã‚‰ã‚³ãƒãƒ³ãƒ‰ã‚‚å‹æ‰‹ã«æ›´æ–°ã™ã‚‹ã‚ˆã†ãªä»•çµ„ã¿ã«ã¯ãªã£ã¦ãªã„ã§ã™
ï¼ŠCLIã‚’ä½œã£ã¦å…¬é–‹ã¾ã§ã‚’ã‚„ã£ã¦ã¿ãŸã‹ã£ãŸã ã‘ãªã®ã§ä½œã‚Šã¯è’ã„ã§ã™ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹é€Ÿåº¦ãªã©è€ƒæ…®ã—ã¦ãªã‹ã£ãŸã‚Šï¼‰

## CLIç´¹ä»‹ç¯‡

### äººç‰©ãƒªã‚¹ãƒˆè¡¨ç¤º - human

ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’ãƒªã‚¹ãƒˆè¡¨ç¤ºã—ã¾ã™ã€‚
ã‚ªãƒ—ã‚·ãƒ§ãƒ³æŒ‡å®šã«ã‚ˆã‚Šã€è­·å»·åä¸‰éšŠã€ä»®é¢ã®è»å‹¢(ãƒ´ã‚¡ã‚¤ã‚¶ãƒ¼ãƒ‰)ã€ååˆƒ(ã‚¨ã‚¹ãƒ‘ãƒ¼ãƒ€)ãªã©ã®ãƒªã‚¹ãƒˆè¡¨ç¤ºãŒã§ãã¾ã™ã€‚
ï¼Šv1.1.0ã‚ˆã‚Šå®Œç¾è¡“è€…ï¼ˆãƒ•ãƒ«ãƒ–ãƒªãƒ³ã‚¬ãƒ¼ï¼‰ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

```shell
blch human --gotei13
```

![output.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/149698/ae04b48b-a258-7bea-7838-6e29931b6aa4.gif)


### æ¦‚è¦è¡¨ç¤º - tldr

ç™»å ´äººç‰©ã®è§£å·ãƒ»æ–¬é­„åˆ€ãƒ»åè§£ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```shell
blch tldr é»’å´ä¸€è­·
```

![output2.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/149698/e5417009-4e1d-1766-4230-6e0b2b8a9775.gif)

éå¸¸ã«ãŠä¸–è©±ã«ãªã£ã¦ã„ã‚‹`tldr`ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰ç€æƒ³ã‚’å¾—ã¦ã„ã¾ã™ã€‚
shellã‚³ãƒãƒ³ãƒ‰ã®èª¬æ˜ã¨ä½¿ç”¨æ–¹æ³•ã‚’æ•°è¡Œã§ç´¹ä»‹ã—ã¦ãã‚Œã¾ã™ã€‚
`brew install tldr`ã§ï¼
https://github.com/tldr-pages/tldr

### å§‹è§£ãƒ»åè§£ - echo

echoã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚Šã€å§‹è§£ã¾ãŸã¯åè§£ã‚’è¡Œã„ã¾ã™ã€‚

```shell
blch echo --shikai æœ½æœ¨ç™½å“‰
blch echo --bankai æœ½æœ¨ç™½å“‰
```

![output3.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/149698/291cb253-4fd3-f37a-5e38-f049881bd4c6.gif)


### ã‚³ãƒãƒ³ãƒ‰çµ„ã¿åˆã‚ã›

```shell
blch human -a | fzf | xargs blch tldr
# ã‚‚ã—ãã¯ï¼ˆï¼Šfishè¨˜æ³•ã§ã™ï¼‰
blch tldr (blch human -a | fzf)
```

![output4.gif](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/149698/6f46e846-fbea-b7c9-f16d-8da83a716908.gif)

ã¡ãªã¿ã«ãƒ­ã‚°ã‚¤ãƒ³ã‚·ã‚§ãƒ«ã¯fishã‚’ä½¿ã£ã¦ã„ã¾ã™ãŒè¶…ãŠã™ã™ã‚ã§ã™ã€‚
[ãƒ­ã‚°ã‚¤ãƒ³ã‚·ã‚§ãƒ«ã‚’fishã«ã—ã¦ã¿ã‚‹ - Qiita](https://qiita.com/bleru/items/047a4e8ea2afb654d9e1)

### helpè¡¨ç¤º

ãã‚Œãã‚Œã®ã‚³ãƒãƒ³ãƒ‰ã«`-h`ã‚’ã¤ã‘ã‚‹ã“ã¨ã§ãƒ˜ãƒ«ãƒ—ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```shell
â¯â¯â¯ blch hu -h
Usage: blch human|hu [options]

Output human names

Options:
  -a, --all          List all
  -g, --gotei13      List gotei 13
  -e, --espada       List espada
  -v, --visored      List visored
  -k, --karakuracho  List karakuracho
  -f, --fullbringer  List fullbringer
  -h, --help         output usage information

  Examples:

    $ blch human --gotei13
    $ blch hu -g

```

## CLIä½œæˆç¯‡
### commander

node.jsã«ãŠã‘ã‚‹CLIã®å®Œç’§ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚
ã¨æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚å®Ÿéš›ä½¿ã„ã‚„ã™ã‹ã£ãŸã§ã™ã€‚â†“
[commander  -  npm](https://www.npmjs.com/package/commander)

commanderã®ä½¿ã„æ–¹ã‚’`blch  human`ã‚³ãƒãƒ³ãƒ‰ã‚’ä¾‹ã«ã¨ã£ã¦èª¬æ˜ã—ã¦ã¿ã¾ã™ã€‚
Typescriptã§ã™ã€‚

`index.ts`

```typescript
import * as program from 'commander';
=====

// ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®ç™»éŒ²
// blch -V or blch --version ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒç¢ºèªã§ãã‚‹
program
  .version('0.0.1', '-V, --version')

// blch humanã‚³ãƒãƒ³ãƒ‰ã®ä½œæˆ
program
  .command('human') // ã‚³ãƒãƒ³ãƒ‰åã®ç™»éŒ² ã“ã“ã§ç™»éŒ²ã—ãŸã‚‚ã®ã‚’`blch ~`ã®å½¢ã§ä½¿ãˆã‚‹
  .alias('hu') // aliasç™»éŒ²ã«ã‚ˆã‚Šã€`blch hu`ã¨æ‰“ã¤ã“ã¨ã‚‚å¯èƒ½
  .description('Output human names') // helpç”¨
	// optionã®ç™»éŒ²ï¼ˆçœç•¥å¯èƒ½ï¼‰
  .option("-a, --all", "List all")
  .option("-g, --gotei13", "List gotei 13")
  .option("-e, --espada", "List espada")
  .option("-v, --visored", "List visored")
  .option("-o, --other", "List other")
  .action( async (cmd, options) => {

	  /**
		`blch human --gotei13`ã‚’å®Ÿè¡Œã—ãŸå ´åˆ
		`cmd`ã«`gotei13`ã®Booleanãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒtrueã§è¿½åŠ ã•ã‚Œã‚‹
		`gotei13`ã¯ä¸Šè¨˜optionã§è¨­å®šã—ãŸ`--gotei13`ã®éƒ¨åˆ†ã«è©²å½“ã™ã‚‹

		`blch human --gotei13 4`ã‚’å®Ÿè¡Œã—ãŸå ´åˆ
		`blch human --gotei13`ã‚’å®Ÿè¡Œã—ãŸæ™‚ã¨cmdã®å†…å®¹ã¯åŒã˜
		optionsã¯['4']ã¨ãªã£ã¦ã„ã‚‹
		ã¤ã¾ã‚Š`--gotei13 4`ã§æŒ‡å®šã—ãŸã‚‚ã®ãŒæ–‡å­—åˆ—ã¨ã—ã¦é…åˆ—ã«å…¥ã‚‹
		
		ä»Šå›ã®blchã‚³ãƒãƒ³ãƒ‰ã§ã¯è€ƒæ…®ã—ã¦ã„ãªã„ãŒã€
		ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®é‡ã­ãŒã‘ã‚‚å¯èƒ½ã€‚
		`blch -g -e`ã¨ã™ã‚‹ã¨cmdã®`gotei13`ã‚‚`espada`ã‚‚trueã«ãªã‚‹
		ã¾ãŸã€`--gotei13 4 5`ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«å…¥ã‚Œã‚‹ã¨
		optinosã¯ã€`['4', '5']`ã¨ãªã‚‹

		ä»¥ä¸‹ã‹ã‚‰`cmd`, `options`ã®å€¤ã§æ¡ä»¶åˆ†å²ã—å‡ºåŠ›ã™ã‚‹å‡¦ç†
	  */

	  // csvãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å…¨ãƒªã‚¹ãƒˆã‚’å–å¾—
    const dataList: Human[] = await files.getHumanDataList()

    let targetCode: GroupCode = 'all'
    if (cmd.gotei13) {
      targetCode = 'gotei13'
    }
    if (cmd.espada) {
      targetCode = 'espada'
    }
    if (cmd.visored) {
      targetCode = 'visored'
    }
    if (cmd.other) {
      targetCode = 'other'
    }
	  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰å¯¾è±¡ã‚’å–å¾—
    const humans = findHumansByGroupCode(dataList, targetCode, options)
    if (humans.length === 0) {
      console.log('No matching')
      return
    }
	  // ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã¸å‡ºåŠ›
    humans.forEach(human => console.log(human.name))

  })
	// helpã®å®šç¾©
  .on('--help', function() {
    console.log('\n  Examples:')
    console.log()
    console.log('    $ blch human --gotei13')
    console.log('    $ blch hu -g')
    console.log()
  })

// blch humanã‚³ãƒãƒ³ãƒ‰ä»¥å¤–ã‚’ä½œæˆã™ã‚‹å ´åˆã¯åŒã˜ã‚ˆã†ã«è¿½åŠ ã—ã¦ã„ã
program
  .command('tldr <target>')
======

// æœ€å¾Œã«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«å¼•æ•°ã‚’parseã™ã‚‹å‡¦ç†
program.parse(process.argv)
```

ã‚µã‚¯ãƒƒã¨ã‚³ãƒãƒ³ãƒ‰ä½œã‚Œã¦è‰¯ã„ã€‚


### chalk

[chalk  -  npm](https://www.npmjs.com/package/chalk)
ã‚¿ãƒ¼ãƒŸãƒŠãƒ«å‡ºåŠ›ã«è‰²ã‚’ã¤ã‘ãŸã‚Šå¤ªå­—ã«ã—ãŸã‚Šã§ãã¾ã™ã€‚

* chalkæœªä½¿ç”¨
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/149698/c24ed2f8-d3dd-a0c5-aba8-ef30658e6c63.png)
* chalkä½¿ç”¨
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/149698/82ba8b04-6e85-6211-92f3-551f8e594fd9.png)

chalkã‚’ä½¿ã†ã“ã¨ã§å‘³ã®ã‚ã‚‹å‡ºåŠ›ã«ãªã‚Šã¾ã™ã€‚

ä»Šå›ã“ã®2ã¤ãã‚‰ã„ã—ã‹CLIç”¨ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ä½¿ã£ã¦ãªã„ã§ã™ãŒã€Nodeã®CLIã«ã¯ä»–ã«ã‚‚ä½¿ãˆãã†ãªã‚‚ã®ã¯è‰²ã€…ã‚ã‚‹ã‚“ã ãªã¨ã„ã†ã“ã¨ã‚’çŸ¥ã‚Œã¾ã—ãŸã€‚
ã“ã¡ã‚‰ã¯gitã®packageè§£æ±ºå‘¨ã‚Šã§ãƒã‚°ã£ã¦ãƒ“ãƒ«ãƒ‰ã§ããªã‹ã£ãŸã‘ã©å‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚
[Build a JavaScript Command Line Interface (CLI) with Node.js â€” SitePoint](https://www.sitepoint.com/javascript-command-line-interface-cli-node-js/)

## CLIå…¬é–‹ç¯‡
ã»ã¼ã“ã‚Œã«æ²¿ã£ã¦è¡Œã£ãŸã®ã§å‚ç…§ã®ã¿è²¼ã‚Šã¾ã™ã€‚
npmã¸ã®å…¬é–‹ã¯æ€ã£ã¦ã„ãŸã‚ˆã‚Šç°¡å˜ã§ã—ãŸã€‚
https://qiita.com/TsutomuNakamura/items/f943e0490d509f128ae2

## ã¾ã¨ã‚
* nodeã§ã®CLIä½œæˆã€œå…¬é–‹ã‚’è¡Œã£ãŸã€‚æ„å¤–ã¨ã™ã‚“ãªã‚Šã§ããŸã€‚
    * goã¨ã‹rubyã¨ã‹rustã¨ã‹pythonã§ã®CLIä½œæˆã¯ã©ã†ãªã‚“ã ã‚ã†
* å®Œå…¨ã«å€‹äººç”¨ã®CLIã ãŒä½œã‚‹ãã£ã‹ã‘ãŒã§ãã€ã€ŒBLEACHã€ã«æ„Ÿè¬ã€‚
    * ç¶²ç¾…ã§ãã¦ã„ãªã„éƒ¨åˆ†ã¯ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“
    * (è¿½è¨˜)åƒå¹´è¡€æˆ¦ç¯‡ã‚¢ãƒ‹ãƒ¡ã‚ã£ã¡ã‚ƒæ¥½ã—ã¿



